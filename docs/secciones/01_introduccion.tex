\chapter{Introducción}
En la creación y presentación de historias existen patrones reconocibles o
convenciones que llamaremos \textit{tropos}, o recursos reiterativos, que tienen
un gran interés como recursos de gran importancia para que los autores puedan
transmitir al público sus ideas. Cada medio tiene su propio lenguaje y forma de
expresarse, sin embargo, en todos ellos subyace la narrativa, que contiene estos
recursos reiterativos \cite{garcia2021simpsons}, por lo que se puede decir que
una obra de cualquier medio se define mejor como un conjunto de \textit{tropos}
\cite{garcia2020tropes}. El análisis de esta información mediante métodos de
ciencia de datos tiene gran interés en la construcción de modelos que ayuden a
los creadores de historias a entender mejor las relaciones que existen entre
estos \textit{tropos} y así crear historias mejores, que se adapten mejor a las
tendencias actuales y sean más interesantes y económicamente rentables. De esto
se deduce que es imprescindible tener un buen conjunto de estos datos para poder
construir modelos los más correctos, completos y actualizados posible.

Toda situación, arquetipo, convención o patrón que sea reconocible por la
audiencia y que se repita a lo largo de una historia se conoce en inglés como
\textit{trope}. Es importante destacar que este término no existe en español
\cite{tesisruben}, por lo que cuando se haga referencia a este concepto a lo
largo del documento se hará en cursiva, al ser una palabra informal, pero se
utilizarán también cualquiera de los otros términos que se han mencionado.

El concepto de \textit{tropo} está estrechamente relacionado con el concepto de
motivo, cuya definición es (Real Academia Española, 2023, definición 3): 

\begin{verbatim}
    ``En arte, rasgo característico que se repite 
    en una obra o en un conjunto de ellas''.
\end{verbatim}


Este rasgo que se repite puede ser una situación, un tipo de personaje, una
estructura narrativa o cualquier patrón que se utilice en la creación,
presentación o publicación de una historia, de forma que no la interrumpa (en
cuyo caso, sería un cliché) sino que ayude a entenderla y construirla mejor. Los
\textit{tropos} tienen interés como una parte imprescindible del puzle que es
producir una obra de cualquier medio, ya sea una serie, película, videojuego o
libro. 

Estos patrones se pueden analizar para obtener una serie de pautas que puedan
servir para crear nuevas obras más efectivas, por ejemplo analizando cómo
evoluciona el uso de \textit{tropos} a lo largo del tiempo y cuáles son los más
adecuados para representar un tipo de género o historia concreta. En resumen,
los \textit{tropos} son clave en la popularidad que puede llegar a tener una
obra y eso hace que surja en internet una comunidad dedicada a analizarlos,
entenderlos y almacenarlos llamada
TvTropes\footnote{\url{https://tvtropes.org/}}. 

TvTropes es un wiki abierto con contenido no estático cuyo principal cometido es
describir y almacenar ejemplos de \textit{tropos} en cualquier tipo de medio
audiovisual, cada uno de ellos con una descripción y ejemplos reales de dónde y
cómo se aplican. Sin embargo, la información de TvTropes va más allá de los
\textit{tropos}, con contenidos relativos a cualquier obra audiovisual agrupados
en sub-páginas como curiosidades, opiniones, información sobre actores o
personajes, vídeos, o cualquier otro tipo de apartado que la comunidad considere
interesante. Al ser un wiki que además usa su propio motor, a diferencia de
otros como MediaWiki que es libre y ampliamente usado y conocido, y que sus
contenidos están escritos y editados por los propios usuarios que lo visitan,
las páginas pueden variar tanto en forma como en contenido. TvTropes indica para
cada entrada de una obra audiovisual, entre otros, todos los \textit{tropos} que
la comunidad del sitio web ha identificado, explicando el por qué y añadiendo
ejemplos, siendo esta la principal fuente de información que proporciona la web.
Esta información está en constante crecimiento.

Sin embargo, tal y como se define en la propia web, el objetivo de TvTropes es
formar una comunidad interesada en el estudio y entendimiento de los
\textit{tropos} que se utilizan para contar historias y también en cualquier
otro tipo de contenido sobre obras audiovisuales, como curiosidades, centrado en
los fans. Debido a esto, su objetivo es mostrarlos de un modo accesible y
divertido de leer, destinado al usuario final. TvTropes no proporciona una
manera oficial de acceder a esta información (mediante una API, por ejemplo) como
un conjunto de datos para su uso en ciencia de datos o inteligencia artificial.
Además de esto, TvTropes es una web centrada principalmente en los
\textit{tropos}, por lo que no siempre manejan toda la información secundaria
sobre los contenidos audiovisuales que tienen, que generalmente se encuentran en
otras fuentes de datos externas como IMDB\footnote{\url{https://www.imdb.com/}},
para películas, o IGDB\footnote{\url{https://www.igdb.com/}}, para videojuegos.
Esta información puede ser por ejemplo la fecha de salida, la lista de actores,
el director, el compositor, la duración, la empresa distribuidora, y un largo
número de características que tienen interés en los análisis o para poder
distinguir entre sí obras que se llamen igual. En TvTropes este tipo de
información, si está, se presenta en forma de un texto resumen y no en secciones
estructuradas y fácilmente identificables.

En estos análisis interesados en el estudio de \textit{tropos} en narrativas
entran trabajos de investigación como \cite{garcia2020tropes}, que describe
estadísticamente cómo se relacionan estos conceptos entre sí y cómo evolucionan
en el tiempo. Estos recursos reiterativos también se pueden combinar entre sí,
como en \cite{garcia2021simpsons}, que identifica qué combinaciones de
\textit{tropos} de películas son más usuales y cuáles pueden obtener buenas
reseñas y popularidad; y en \cite{any2vec}, que propone un modelo que analiza
conjuntos de tropos para su análisis mediante técnicas del procesamiento de
lenguaje natural. Este tipo de investigaciones parten de conjuntos de datos
distintos según las necesidades que tengan y, por tanto, actúan como principal
motivación de este proyecto, ya que, necesitan que estos conjuntos de datos
estén correctamente actualizados y preparados. De aquí surge la necesidad de una
buena herramienta que permita explorar cualquier página de TvTropes para extraer
exactamente los contenidos que se necesitan.

Explorar toda la información que provee TvTropes es todo un reto al ser una web
en constante cambio en la que la comunidad puede añadir nuevos \textit{tropos} o
películas, cambios en ellos o en sus relaciones, que requieren de estar siempre
al día con los contenidos. Entre el año 2016 y 2020 los \textit{tropos} que más
aparecen en películas fueron sustituidos por otros nuevos, el número de
películas aumentó en un $99.6\%$ y la media de \textit{tropos} en películas
aumentó un $279.38\%$\cite{garcia2020tropes}. Además, viendo la propia sección
de la web que indica todos los cambios que se hacen en
ella\footnote{\url{https://tvtropes.org/pmwiki/changes.php}}, se puede observar
como se realizan cambios, algunos de gran importancia etiquetados en la página
como \begin{otherlanguage}{english}``\textit{Large edit}''\end{otherlanguage},
diariamente. Todo esto muestra la rápida evolución de los contenidos de la web y
la importancia de estar al día con ellos. 

Por otro lado, las páginas de TvTropes manejan información secundaria que a
veces no está presente y, en los casos en los que sí lo está, esta información
no está estructurada sino que se encuentra dentro de un texto pensado solo para
ser entendible por un lector humano. Además, muchas de las páginas siguen
esqueletos distintos como base para mostrar unos mismos contenidos y esto
dificulta el que un programa automático entienda la página que está explorando.
Estos son los principales problemas que se deben tener en cuenta a la hora de
construir una buena herramienta que sea capaz de extraer esta información y
representarla como un conjunto de datos analizable. La resolución de estos
problemas motiva este trabajo, que busca solucionarlos mediante el desarrollo de
un \textit{scraper}, un programa informático que sea capaz de descargar,
entender y organizar los datos de una web de forma autónoma
\cite{apress2018scraping}.

Varios de los trabajos de investigación mencionados usan una herramienta llamada
Tropescraper, un \textit{scraper} de TvTropes que no consigue extraer toda la
información que tiene la web actualmente, la cual ha cambiado bastante con el
tiempo, y que este proyecto usa como base de inspiración para mejorarla y
aumentar sus funcionalidades. En este trabajo se estudian los problemas que
tiene este \textit{scraper}, que se pueden resumir en que no explora
correctamente todas las páginas, requiere de un tiempo demasiado grande para
ejecutarse y extraer todos los contenidos, no está al día con los cambios en la
estructura de la wiki y que la información no se añade mediante incrementos por
lo que hay que relanzar de nuevo el scraper cuando se quieran actualizar los
datos. A esto se suman nuevas necesidades que surgen del proceso de estudio y
desarrollo a lo largo de este trabajo y que se pretenden resolver: el usuario
debe poder obtener solamente la información que necesita, sin necesidad de
explorar toda la web, y además poder obtener los datos en distintos formatos
estandarizados en ciencia de datos. En general, estudiar a los usuarios que se
beneficiarían de una herramienta de este tipo y comprender sus necesidades.

Por tanto, el propósito de este TFM es el de aportar una solución informática a
la extracción de datos de TvTropes que sea sostenible, es decir, que se adapte a
los cambios de estructura de esta página y pueda entender si sus contenidos son
extraíbles. Esta solución deberá tener en cuenta todas sus particularidades y
las necesidades de aquellos usuarios que usan la información de \textit{tropos}
para construir modelos y análisis; la necesidad de tener un conjunto de datos
bien preparado y limpio, la gran cantidad de información que ofrece la web, el
difícil acceso a esta debido a las distintas formas de organización que presenta
una página de TvTropes para presentarla por su condición de wiki y lo rápido que
evolucionan estos contenidos. Para lograr esto se construirá un \textit{scraper}
que sea capaz de entender y explorar la estructura de las páginas y contenidos
actuales de TvTropes para extraer su información. Con esta herramienta se quiere
que un usuario pueda obtener datos actualizados, correctos y preparados para su
análisis con métodos de ciencia de datos. Se busca además ampliar su
funcionalidad para que el \textit{scraper} obtenga información de metadatos
adicional y el usuario pueda extraer \textit{tropos} de cualquier medio
audiovisual, elegir qué partes de la información quiere según varios criterios y
elegir el formato de datos más adecuado para representarla.

Este trabajo se divide en tres partes diferenciadas:
\begin{itemize}
    \item En los \textbf{capítulos del 1 al 3} se entiende el trabajo y su
    contexto, describiendo el problema que se desea resolver y los objetivos que
    se quieren alcanzar, para luego en el estado del arte entender mejor el
    dominio del problema analizando las alternativas que existen actualmente en
    materia de scrapers y herramientas que extraen la información de la web de
    TvTropes, así como la situación actual de la propia página y los retos que
    presenta a la hora de extraer su información.
    \item La segunda parte, conformada por los \textbf{capítulos 4 y 5}, se
    centrará en los aspectos necesarios para poner el proyecto a punto,
    planificando su desarrollo, explicando la metodología a seguir, las
    herramientas que se utilizarán y modelando el problema para poder proceder a
    la implementación del \textit{software}.
    \item Por último, en los \textbf{capítulos 6 y 7} se desarrollará todo el
    trabajo realizado y cómo se ha llegado a la solución final, valorando
    finalmente si se han alcanzado los objetivos propuestos y qué se deja como
    trabajo para el futuro.
\end{itemize}

Este proyecto es software libre, está liberado con la licencia
GPLv3\footnote{\url{http://www.gnu.org/licenses/gpl.html}} y se puede encontrar
en un repositorio público de
GitHub\footnote{\url{https://github.com/jlgallego99/TropesToGo}}.

